/**
 * "ㅇㅇ" 확인 응답 전용 규칙
 *
 * 이 파일은 사용자가 "ㅇㅇ", "응", "그래", "해줘" 등으로
 * AI의 제안을 확인했을 때만 적용되는 절대 규칙입니다.
 */

const CONFIRMATION_RULES = `
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🚨🚨🚨 "ㅇㅇ" 확인 응답 절대 규칙 🚨🚨🚨
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 핵심 원칙
**사용자가 확인한 것은 오직 [삭제 예정] 목록뿐입니다!**
**추가 조건, 추가 필터, 추가 삭제는 절대 금지입니다!**
**요일 맥락 무시! [삭제 예정]에 월/수/금 있으면 3개 요일 전부 삭제!**

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 1️⃣ 직전 AI 응답에서 [삭제 예정] 목록 찾기

🚨 중요: 요일 여러 개 있으면 **모든 요일**의 항목 삭제!
- 월요일 3개 + 수요일 3개 + 금요일 3개 = 총 9개 삭제
- 현재 대화 요일이 금요일이어도 월/수요일도 삭제!

**예시 1: 요일 1개인 경우**
직전 AI 응답:
"""
[삭제 예정]
• 금요일: 영어 (09:00-09:50), 과학 (10:00-10:50), 사회 (11:00-11:50)
"""
→ 금요일 영어, 금요일 과학, 금요일 사회 **딱 3개만 삭제**

**예시 2: 요일 여러 개인 경우 (중요!)**
직전 AI 응답:
"""
[삭제 예정 - 학원 수업 있는 날의 학교 수업]
• 월요일: 도덕 (09:00-09:50), 영어 (10:00-10:50), 수학 (11:00-11:50)
• 수요일: 음악 (09:00-09:50), 과학 (10:00-10:50), 영어 (11:00-11:50)
• 금요일: 영어 (09:00-09:50), 과학 (10:00-10:50), 사회 (11:00-11:50)
"""
→ **모든 요일의 모든 항목 삭제! 총 9개!**
→ 월요일 3개 + 수요일 3개 + 금요일 3개 = 9개
→ 현재 대화 요일이 금요일이어도 월/수요일도 삭제!

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 2️⃣ 삭제 대상 찾기 - title과 startTime만 매칭!

**✅ 올바른 방법:**
\`\`\`javascript
// [삭제 예정] 목록
const deleteList = [
  { title: "영어", startTime: "09:00" },
  { title: "과학", startTime: "10:00" },
  { title: "사회", startTime: "11:00" }
];

// 원본 스케줄에서 매칭
const result = originalSchedule.filter(item => {
  // [삭제 예정]에 있는지만 확인
  const shouldDelete = deleteList.some(del =>
    item.title === del.title &&
    item.startTime === del.startTime
  );

  return !shouldDelete; // 삭제 대상이 아니면 유지
});
\`\`\`

**❌ 절대 금지 - type이나 다른 조건 추가:**
\`\`\`javascript
// ❌ 이렇게 하면 안 됨!
const result = originalSchedule.filter(item => {
  if (item.type === "school" && item.days.includes("FRI")) {
    return false; // ← 이건 [삭제 예정]에 없던 조건!
  }
  return true;
});
\`\`\`

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 3️⃣ 절대 해서는 안 되는 것들

🚫 **금지 1: type 조건 추가**
- [삭제 예정]에 "학교 수업"이라고 써있어도
- **type === "school" 조건을 추가로 적용하면 안 됨!**
- 목록에 있는 것만 삭제!

예시:
[삭제 예정]에 "영어, 과학, 사회" 3개만 있음
→ 3개만 삭제! 금요일 다른 학교 수업 삭제 금지!
→ 학원 수업은 당연히 삭제 금지! (목록에 없음)

🚫 **금지 2: 요일 조건 확장**
- [삭제 예정]에 "금요일: 영어" 있음
- **"금요일 학교 수업 전부"로 확장 금지!**
- 목록에 있는 "영어"만 삭제!

🚫 **금지 3: 시간 범위 확장**
- [삭제 예정]에 "영어 (09:00-09:50)" 있음
- **"09:00 이후 전부"로 확장 금지!**
- 목록에 있는 "영어 09:00"만 삭제!

🚫 **금지 4: "~있는 날" 해석**
- [삭제 예정]에 "금요일: 영어, 과학" 2개 있음
- **"학원 있는 날이니까 학원도 삭제"는 절대 금지!**
- 목록에 있는 2개만 삭제!

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 4️⃣ 체크리스트 (모두 체크되어야 함!)

삭제 실행 전 반드시 확인:

- [ ] 직전 AI 응답에서 [삭제 예정] 목록을 찾았는가?
- [ ] 그 목록에 있는 항목 개수를 정확히 세었는가?
- [ ] title과 startTime만으로 매칭했는가?
- [ ] type, days, 시간 범위 등 **추가 조건을 적용하지 않았는가?**
- [ ] 삭제할 개수 = [삭제 예정] 목록 개수인가?
- [ ] [삭제 예정]에 없던 항목(학원 수업 등)을 삭제하지 않았는가?
- [ ] [삭제 예정]의 마지막 항목도 삭제했는가?

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 5️⃣ 실제 예시

**상황:**
직전 AI: "[삭제 예정] 금요일: 영어 (09:00-09:50), 과학 (10:00-10:50), 사회 (11:00-11:50)"
사용자: "ㅇㅇ"

**원본 스케줄:**
[
  { title: "영어", type: "school", days: ["FRI"], startTime: "09:00", endTime: "09:50" },
  { title: "과학", type: "school", days: ["FRI"], startTime: "10:00", endTime: "10:50" },
  { title: "사회", type: "school", days: ["FRI"], startTime: "11:00", endTime: "11:50" },
  { title: "국어", type: "school", days: ["FRI"], startTime: "12:00", endTime: "12:50" },
  { title: "주니어A", type: "academy", days: ["FRI"], startTime: "15:00", endTime: "15:40" }
]

**✅ 올바른 결과 (3개만 삭제):**
[
  { title: "국어", type: "school", days: ["FRI"], startTime: "12:00", endTime: "12:50" },
  { title: "주니어A", type: "academy", days: ["FRI"], startTime: "15:00", endTime: "15:40" }
]

**❌ 잘못된 결과 (type 조건 추가로 국어도 삭제):**
[
  { title: "주니어A", type: "academy", days: ["FRI"], startTime: "15:00", endTime: "15:40" }
]
→ 국어는 [삭제 예정]에 없었는데 type === "school"이라서 삭제됨 (잘못!)

**❌ 잘못된 결과 (학원도 삭제):**
[]
→ 주니어A는 [삭제 예정]에 없었는데 삭제됨 (잘못!)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

## 6️⃣ 최종 확인

삭제 후 반드시 검증:
1. 삭제된 항목 개수 = [삭제 예정] 목록 개수?
2. 삭제된 항목의 title과 startTime이 목록과 정확히 일치?
3. 목록에 없던 항목은 모두 유지?

**만약 개수가 다르면:**
→ 무언가 잘못됨! 다시 확인 필요!
→ 추가 조건을 적용했을 가능성 높음!

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
`;

module.exports = { CONFIRMATION_RULES };
